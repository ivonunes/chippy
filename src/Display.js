export class Display {
  constructor (processor) {
    this.canvas = document.getElementById('screen').getContext('2d')
    this.processor = processor
  }

  render () {
    if (this.processor.drawFlag === false) {
      return
    }

    this.canvas.fillStyle = 'rgba(0, 0, 0, 1)'
    this.canvas.fillRect(0, 0, 64 * 15, 32 * 15)
    this.canvas.fillStyle = '#FFFFFF'

    for (let i = 0; i < this.processor.vram.length; i++) {
      if (this.processor.vram[i] === 1) {
        let y = i / 64 | 0
        let x = i - y * 64

        this.canvas.fillRect(x * 15, y * 15, 15, 15)
      }
    }

    this.processor.drawFlag = false
  }

  static getFontset () {
    return [
      0xF0, 0x90, 0x90, 0x90, 0xF0, // 0
      0x20, 0x60, 0x20, 0x20, 0x70, // 1
      0xF0, 0x10, 0xF0, 0x80, 0xF0, // 2
      0xF0, 0x10, 0xF0, 0x10, 0xF0, // 3
      0x90, 0x90, 0xF0, 0x10, 0x10, // 4
      0xF0, 0x80, 0xF0, 0x10, 0xF0, // 5
      0xF0, 0x80, 0xF0, 0x90, 0xF0, // 6
      0xF0, 0x10, 0x20, 0x40, 0x40, // 7
      0xF0, 0x90, 0xF0, 0x90, 0xF0, // 8
      0xF0, 0x90, 0xF0, 0x10, 0xF0, // 9
      0xF0, 0x90, 0xF0, 0x90, 0x90, // A
      0xE0, 0x90, 0xE0, 0x90, 0xE0, // B
      0xF0, 0x80, 0x80, 0x80, 0xF0, // C
      0xE0, 0x90, 0x90, 0x90, 0xE0, // D
      0xF0, 0x80, 0xF0, 0x80, 0xF0, // E
      0xF0, 0x80, 0xF0, 0x80, 0x80  // F
    ]
  }
}
